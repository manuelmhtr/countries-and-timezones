{"version":3,"file":"index.min.js","sources":["../src/build-country.js","../src/build-timezone.js","../src/index.js"],"sourcesContent":["let timezonesMap;\n\nexport default function buildCountry(data, id) {\n  const name = data.countries[id];\n  if (!name) return null;\n\n  const tzMap = getTimezonesMap(data)[id] || {};\n\n  return {\n    id,\n    name,\n    timezones: tzMap.current || [],\n    allTimezones: tzMap.all || [],\n  };\n}\n\nfunction getTimezonesMap(data) {\n  timezonesMap ||= buildTimezonesMap(data);\n  return timezonesMap;\n}\n\nfunction buildTimezonesMap(data) {\n  return Object.keys(data.timezones).reduce((result, id) => {\n    const tz = data.timezones[id];\n    const {c, a} = tz;\n    const aliasTz = data.timezones[a] || {};\n    const countries = c || aliasTz.c;\n\n    if (!countries) return result;\n\n    for (const country of countries) {\n      if (!result[country])\n        Object.assign(result, {[country]: {current: [], all: []}});\n      if (tz.r === undefined) result[country].current.push(id);\n      result[country].all.push(id);\n    }\n\n    return result;\n  }, {});\n}\n","export default function buildTimezone(data, name) {\n  const timezone = data.timezones[name];\n  if (!timezone) return null;\n\n  const {a: aliasOf = null} = timezone;\n  const aliasTz = aliasOf ? data.timezones[aliasOf] : {};\n  const tz = {\n    ...aliasTz,\n    ...data.timezones[name],\n  };\n\n  const countries = tz.c || [];\n  const utcOffset = tz.u;\n  const dstOffset = Number.isInteger(tz.d) ? tz.d : utcOffset;\n\n  const result = {\n    name,\n    countries,\n    utcOffset,\n    utcOffsetStr: getOffsetString(utcOffset),\n    dstOffset,\n    dstOffsetStr: getOffsetString(dstOffset),\n    aliasOf,\n  };\n  if (timezone.r) result.deprecated = true;\n  return result;\n}\n\nfunction getOffsetString(offset) {\n  const hours = Math.floor(Math.abs(offset) / 60);\n  const min = offset % 60;\n  const sign = offset < 0 ? '-' : '+';\n\n  return `${sign}${getNumberString(hours)}:${getNumberString(min)}`;\n}\n\nfunction getNumberString(input) {\n  const number_ = Math.abs(input);\n  const prefix = number_ < 10 ? '0' : '';\n  return `${prefix}${number_}`;\n}\n","import data from './data.json';\nimport buildCountry from './build-country.js';\nimport buildTimezone from './build-timezone.js';\n\nconst totalTimezones = Object.keys(data.timezones).length;\nconst countries = {};\nconst timezones = {};\nlet memoizedTimezones = 0;\n\nexport function getAllCountries(options = {}) {\n  return Object.keys(data.countries).reduce((previous, id) => {\n    return Object.assign(previous, {[id]: getCountry(id, options)});\n  }, {});\n}\n\nexport function getAllTimezones(options = {}) {\n  if (totalTimezones !== memoizedTimezones)\n    for (const name of Object.keys(data.timezones)) {\n      getTimezone(name);\n    }\n\n  return deliverTimezones(timezones, options);\n}\n\nexport function getCountry(id, options = {}) {\n  if (!countries[id]) memoizeCountry(buildCountry(data, id));\n  return deliverCountry(countries[id], options);\n}\n\nfunction memoizeCountry(country) {\n  if (!country) return;\n  countries[country.id] = country;\n}\n\nexport function getTimezone(name) {\n  if (!timezones[name]) memoizeTimezone(buildTimezone(data, name));\n  return timezones[name] ? {...timezones[name]} : null;\n}\n\nfunction memoizeTimezone(timezone) {\n  if (!timezone) return;\n  timezones[timezone.name] = timezone;\n  memoizedTimezones = Object.keys(timezone).length;\n}\n\nexport function getCountriesForTimezone(tzName, options = {}) {\n  const timezone = getTimezone(tzName) || {};\n  const values = timezone.countries || [];\n  return values.map((c) => getCountry(c, options));\n}\n\nexport function getCountryForTimezone(tzName, options = {}) {\n  const [main] = getCountriesForTimezone(tzName, options);\n  return main || null;\n}\n\nexport function getTimezonesForCountry(countryId, options = {}) {\n  const country = getCountry(countryId, options);\n  if (!country) return null;\n  const values = country.timezones || [];\n  return values.map((timezone) => getTimezone(timezone));\n}\n\nfunction deliverTimezones(tzs, options) {\n  const {deprecated} = options || {};\n  if (deprecated === true) return tzs;\n  return Object.keys(tzs).reduce((previous, key) => {\n    if (!tzs[key].deprecated) Object.assign(previous, {[key]: tzs[key]});\n    return previous;\n  }, {});\n}\n\nfunction deliverCountry(country, options) {\n  if (!country) return null;\n  const {deprecated} = options || {};\n  const {allTimezones, ...other} = country;\n  const tz = deprecated ? country.allTimezones : country.timezones;\n  return {...other, timezones: tz};\n}\n\nconst utils = {\n  getCountry,\n  getTimezone,\n  getAllCountries,\n  getAllTimezones,\n  getTimezonesForCountry,\n  getCountriesForTimezone,\n  getCountryForTimezone,\n};\n\nexport default utils;\n"],"names":["timezonesMap","buildCountry","data","id","name","countries","tzMap","Object","keys","timezones","reduce","result","tz","c","a","aliasTz","_step","_iterator","_createForOfIteratorHelper","s","n","done","country","value","assign","_defineProperty","current","all","undefined","r","push","err","e","f","buildTimezonesMap","getTimezonesMap","allTimezones","getOffsetString","offset","hours","Math","floor","abs","min","concat","getNumberString","input","number_","totalTimezones","length","memoizedTimezones","getAllCountries","options","arguments","previous","getCountry","getAllTimezones","_i","_Object$keys","getTimezone","tzs","_ref","deprecated","key","deliverTimezones","memoizeCountry","_ref2","other","_objectWithoutProperties","_excluded","_objectSpread","deliverCountry","timezone","memoizeTimezone","_timezone$a","aliasOf","utcOffset","u","dstOffset","Number","isInteger","d","utcOffsetStr","dstOffsetStr","buildTimezone","getCountriesForTimezone","tzName","map","getCountryForTimezone","_slicedToArray","getTimezonesForCountry","countryId","utils"],"mappings":"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"}